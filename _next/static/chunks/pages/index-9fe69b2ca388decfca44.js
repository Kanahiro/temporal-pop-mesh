(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3022:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var r=n(5893);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){if(e){if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l=n(2739),s=n.n(l),u=(n(7111),n(7294));function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){o=!0,a=s}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=n(6156),h=(n(7293),"rgb(204, 204, 204)"),m=function(e){var t=e.length,n=e.pagingSpeed,r=e.onSliderValueChange,o=document.createElement("div");o.classList.add("mapboxgl-ctrl"),o.classList.add("mapboxgl-ctrl-group"),o.style.width="240px",o.style.height="84px",o.style.backgroundColor="#fff",o.style.textAlign="center";var a=document.createElement("div");a.innerHTML="<br />",a.style.marginTop="4px",o.appendChild(a);var i=document.createElement("input");i.type="range",i.value="0",i.min="0",i.max=String(t-1),i.addEventListener("input",(function(){r()})),i.style.width="80%",i.style.margin="4px 0",o.appendChild(i);var l=document.createElement("div");l.style.display="flex",l.style.justifyContent="center",l.style.margin="4px 0 0 0";var s=document.createElement("button");s.innerHTML='<span class="material-icons">loop</span>',s.style.border="0",s.style.borderRadius="0",s.style.marginRight="16px",s.style.height="24px",s.onclick=function(){s.style.backgroundColor=""===s.style.backgroundColor?h:""},l.appendChild(s);var u=function(){return i.value=String(Math.max(0,Number(i.value)-1)),r(),Number(i.min)<Number(i.value)},c=function(){if(""!==s.style.backgroundColor&&Number(i.value)==Number(i.max))for(;u(););else i.value=String(Math.min(Number(i.max),Number(i.value)+1));return r(),Number(i.value)<Number(i.max)},f=document.createElement("button");f.innerHTML='<span class="material-icons">skip_previous</span>',f.onclick=u,f.style.border="0",f.style.height="24px";var d=document.createElement("button");d.innerHTML='<span class="material-icons">pause</span>',d.style.border="0",d.style.height="24px";var p=document.createElement("button");p.innerHTML='<span class="material-icons">play_arrow</span>',p.style.border="0",p.style.height="24px",p.onclick=function(){if(p.style.backgroundColor!==h){p.style.backgroundColor=h;var e=setInterval((function(){c()}),n);d.onclick=function(){clearInterval(e),d.onclick=null,p.style.backgroundColor=""}}};var m=document.createElement("button");return m.innerHTML='<span class="material-icons">skip_next</span>',m.style.border="0",m.style.height="24px",m.onclick=c,l.appendChild(f),l.appendChild(d),l.appendChild(p),l.appendChild(m),o.appendChild(l),[o,a,i]},v=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(this,e),(0,p.Z)(this,"map",void 0),(0,p.Z)(this,"options",void 0),(0,p.Z)(this,"container",void 0),(0,p.Z)(this,"containerTitle",void 0),(0,p.Z)(this,"temporalSlider",void 0),(0,p.Z)(this,"temporalLayers",void 0),this.temporalLayers=t,this.options=r;var o={length:this.temporalLayers.length,pagingSpeed:this.options.speed||500,onSliderValueChange:function(){return n.refresh()}},a=m(o),i=c(a,3);this.container=i[0],this.containerTitle=i[1],this.temporalSlider=i[2]}var t,n,r;return t=e,(n=[{key:"onAdd",value:function(e){var t=this;return this.map=e,e.getContainer().appendChild(this.container),this.map.once("load",(function(){t.refresh()})),this.container}},{key:"onRemove",value:function(){var e;null===(e=this.container.parentNode)||void 0===e||e.removeChild(this.container),this.map=void 0}},{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"refresh",value:function(){var e,t=this;this.temporalLayers.forEach((function(e){var n;null===(n=t.map)||void 0===n||n.setFilter(e.id,!1)}));var n=Number(this.temporalSlider.value),r=this.temporalLayers[n],o=r.id,a=r.title;this.containerTitle.innerHTML=a||o,null===(e=this.map)||void 0===e||e.setFilter(o,!0)}}])&&d(t.prototype,n),r&&d(t,r),e}(),y=n(4522),b=function(e){return(0,r.jsx)("div",{className:"mr-1 rounded border border-black border-opacity-30 bg-white p-2 w-20 text-center",children:e})},g=function(e){return(0,r.jsx)("span",{className:"ml-1",children:e})},x=function(e){var t=e.targetData,n=e.setTargetData,o=(0,u.useState)("d0"),a=o[0],i=o[1],l=(0,u.useState)("t0"),s=l[0],c=l[1];return(0,u.useEffect)((function(){var e=t.substring(0,2),n=t.substring(2,4);i(e),c(n)}),[t]),(0,u.useEffect)((function(){n(a+s)}),[a,s]),(0,r.jsxs)("div",{className:"flex",children:[b((0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"font-semibold mb-1",children:"\u65e5\u4ed8\u7a2e\u5225"}),(0,r.jsxs)(y.Ee,{name:"day",selectedValue:a,onChange:i,children:[(0,r.jsxs)("label",{children:[(0,r.jsx)(y.Y8,{value:"d0"}),g("\u4f11\u65e5")]}),(0,r.jsx)("br",{}),(0,r.jsxs)("label",{children:[(0,r.jsx)(y.Y8,{value:"d1"}),g("\u5e73\u65e5")]}),(0,r.jsx)("br",{}),(0,r.jsxs)("label",{children:[(0,r.jsx)(y.Y8,{value:"d2"}),g("\u5168\u65e5")]})]})]})),b((0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"font-semibold mb-1",children:"\u6642\u9593\u5e2f"}),(0,r.jsxs)(y.Ee,{name:"time",selectedValue:s,onChange:c,children:[(0,r.jsxs)("label",{children:[(0,r.jsx)(y.Y8,{value:"t0"}),g("\u663c\u9593")]}),(0,r.jsx)("br",{}),(0,r.jsxs)("label",{children:[(0,r.jsx)(y.Y8,{value:"t1"}),g("\u6df1\u591c")]}),(0,r.jsx)("br",{}),(0,r.jsxs)("label",{children:[(0,r.jsx)(y.Y8,{value:"t2"}),g("\u7d42\u65e5")]})]})]}))]})},j=["201901","201902","201903","201904","201905","201906","201907","201908","201909","201910","201911","201912","202001","202002","202003","202004","202005","202006","202007","202008","202009","202010","202011","202012"],C=function(e){return j.map((function(t){return{id:t,type:"fill",source:"mesh","source-layer":t,paint:{"fill-color":["interpolate",["linear"],["get",e],0,"#ffffff",100,"#0000ff",5e3,"#00ff00",1e4,"#ffff00",3e4,"#ff0000",1e5,"#990000"],"fill-opacity":["interpolate",["linear"],["get",e],0,0,100,.1,5e3,.2,1e4,.3,3e4,.4,1e5,.4]},filter:["boolean",!1]}}))},k={version:8,sources:{},layers:[]},w=function(){var e=(0,u.useState)(null),t=e[0],n=e[1],o=(0,u.useState)(k),a=o[0],l=o[1],c=(0,u.useState)("d0t0"),f=c[0],d=c[1],p=(0,u.useState)(null),h=p[0],m=p[1],y=(0,u.useRef)(null);return(0,u.useEffect)((function(){if(null!==y.current){var e=new(s().Map)({container:y.current,style:a,center:[139.7,35.7],zoom:9,minZoom:6,maxZoom:18,customAttribution:"<a href='https://www.geospatial.jp/ckan/dataset/mlit-1km-fromto' target='_blank'>\u5168\u56fd\u306e\u4eba\u6d41\u30aa\u30fc\u30d7\u30f3\u30c7\u30fc\u30bf</a> | <a href='https://twitter.com/kanahiro_iguchi' target='_blank'>@kanahiro_iguchi</a>"});n(e);var t=new v(j.map((function(e){return{id:e,title:e.substring(0,4)+"/"+e.substring(4,7)}})));e.addControl(t),m(t)}}),[]),(0,u.useEffect)((function(){var e={version:8,sources:{OSM:{type:"raster",tiles:["http://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:'<a href="http://osm.org/copyright">\xa9 OpenStreetMap contributors</a>'},mesh:{type:"vector",tiles:["https://kanahiro.github.io/temporal-pop-mesh/meshes/{z}/{x}/{y}.pbf"],minzoom:9,maxzoom:9}},layers:[{id:"OSM",type:"raster",source:"OSM",minzoom:0,maxzoom:18}].concat(i(C(f)))};l(e)}),[f]),(0,u.useEffect)((function(){null===t||void 0===t||t.setStyle(a),null===h||void 0===h||h.refresh()}),[a]),(0,r.jsx)("div",{style:{height:"80vh"},ref:y,children:(0,r.jsx)("div",{className:"absolute left-2 top-2 z-10",children:(0,r.jsx)(x,{targetData:f,setTargetData:d})})})},O=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"font-bold text-lg",children:"\u6642\u7cfb\u5217\u3067\u898b\u308b1km\u30e1\u30c3\u30b7\u30e5\u4eba\u6d41\u30de\u30c3\u30d7 - 2019/01~2020/12"}),(0,r.jsx)(w,{})]})}},5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3022)}])},7111:function(){},7293:function(){},4522:function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var o=e,a=t,i=n;r=!1,null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(i)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=a,n=i,r=!0,l=u=void 0}};function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=i(n(5697)),c=i(n(7294)),f=function(e){function t(){l(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return s(t,e),o(t,[{key:"render",value:function(){var e=this.context.radioGroup,t=e.name,n=e.selectedValue,o=e.onChange,a={};return void 0!==n&&(a.checked=this.props.value===n),"function"===typeof o&&(a.onChange=o.bind(null,this.props.value)),c.default.createElement("input",r({},this.props,{type:"radio",name:t},a))}}]),t}(c.default.Component);t.Y8=f,f.contextTypes={radioGroup:u.default.object};var d=function(e){function t(){l(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return s(t,e),o(t,[{key:"getChildContext",value:function(){var e=this.props;return{radioGroup:{name:e.name,selectedValue:e.selectedValue,onChange:e.onChange}}}},{key:"render",value:function(){var e=this.props,t=e.Component,n=(e.name,e.selectedValue,e.onChange,e.children),r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["Component","name","selectedValue","onChange","children"]);return c.default.createElement(t,r,n)}}]),t}(c.default.Component);t.Ee=d,d.defaultProps={Component:"div"},d.propTypes={name:u.default.string,selectedValue:u.default.oneOfType([u.default.string,u.default.number,u.default.bool]),onChange:u.default.func,children:u.default.node.isRequired,Component:u.default.oneOfType([u.default.string,u.default.func,u.default.object])},d.childContextTypes={radioGroup:u.default.object}}},function(e){e.O(0,[774,644,240,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);